addpath('../tforms');

%load the data
data = load('../results/Test_8.2.mat');

cam = cell(5,1);
%ground truths
% cam{1} = [-1.21419616208998,1.21203736275256,-1.21177985862000];
% cam{2} = [-0.319534762758528,2.05445433251589,-2.05371544137282];
% cam{3} = [-0.849687331714648,-1.65304330886712,1.65693356179116];
% cam{4} = [-1.44643610474523,-0.731108953205508,0.736002404638136];
% cam{5} = [-1.56305107449111,0.247450242313341,-0.250579019997943];

B = V2R([1.20919957615615,1.20919957615615,1.20919957615615]);

cam{1} = [0.0484000000000000,0.00199999999999296,-1.25080000530718,1.20211092937477,1.20961526642088,1.20986910007535];
cam{2} = [0.0174000000000000,0.0399999999998592,-1.25080010614359,0.321648843322774,2.05452108848910,2.05525481567922];
cam{3} = [-0.0286000000000000,0.0229999999999190,-1.25080006103257,0.839913311359727,-1.65432453554304,-1.65043602865694];
cam{4} = [-0.0266000000000000,-0.0259999999999085,-1.25079993100667,1.44057553031987,-0.735397827613431,-0.730506457315498];
cam{5} = [0.0214000000000000,-0.0389999999998627,-1.25079989651000,1.54982618157996,0.250125618835807,0.247001846910842];

gt = cell(5,5);
for i = 1:5
    for j = 1:5
        gt{i,j} = V2R(cam{i}(4:6))\V2R(cam{j}(4:6));
    end
end

err = zeros(3,length(data.results),20);
errI = err;

for i = 1:length(data.results)
    v = [0,0,0];
    m = 0;
    for j = 1:5
        for k = 1:5
            if(j == k)
                continue;
            end
            m = m + 1;
            
            R = V2R(data.results{i}.rot(j,:)) \ V2R(data.results{i}.rot(k,:));
            R = (B*R) / (B*gt{j,k});
            [r,p,y] = dcm2angle(R(1:3,1:3));
            v = abs([r,p,y])*180/pi;
            err(:,i,m) = v;
        end
    end
end

for i = 1:length(data.results)
    v = [0,0,0];
    m = 0;
    for j = 1:5
        for k = 1:5
            if(j == k)
                continue;
            end
            m = m + 1;
            
            R = V2R(data.results{i}.rotI(j,:)) \ V2R(data.results{i}.rotI(k,:));
            R = (B*R) / (B*gt{j,k});
            [r,p,y] = dcm2angle(R(1:3,1:3));
            v = abs([r,p,y])*180/pi;
            errI(:,i,m) = v;
        end
    end
end

err = mean(err,3);
errI = mean(errI,3);
err = reshape(err,3,[])';
errI = reshape(errI,3,[])';

%% plot data
%boxplot([err(:,1),errI(:,1),err(:,2),errI(:,2),err(:,3),errI(:,3)],{'Comb Roll','Sep Roll','Comb Pitch','Sep Pitch','Comb Yaw','Sep Yaw'});
boxplot(err,{'Roll','Pitch','Yaw'});