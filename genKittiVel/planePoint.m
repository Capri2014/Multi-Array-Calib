function [ pos ] = planePoint( pos2D, P, N, x0 )
%PLANEERORR Summary of this function goes here
%   Detailed explanation goes here

pos = zeros(size(pos2D,1),3);
pos(:,1) = -(N(:,2).*P(1,3).*P(2,4) - N(:,2).*P(1,4).*P(2,3) - N(:,3).*P(1,2).*P(2,4) + N(:,3).*P(1,4).*P(2,2) - N(:,1).*P(1,2).*P(2,3).*x0(:,1) + N(:,1).*P(1,3).*P(2,2).*x0(:,1) + N(:,2).*P(2,3).*P(3,4).*pos2D(:,1) - N(:,2).*P(2,4).*P(3,3).*pos2D(:,1) - N(:,3).*P(2,2).*P(3,4).*pos2D(:,1) + N(:,3).*P(2,4).*P(3,2).*pos2D(:,1) - N(:,2).*P(1,2).*P(2,3).*x0(:,2) + N(:,2).*P(1,3).*P(2,2).*x0(:,2) - N(:,2).*P(1,3).*P(3,4).*pos2D(:,2) + N(:,2).*P(1,4).*P(3,3).*pos2D(:,2) + N(:,3).*P(1,2).*P(3,4).*pos2D(:,2) - N(:,3).*P(1,4).*P(3,2).*pos2D(:,2) - N(:,3).*P(1,2).*P(2,3).*x0(:,3) + N(:,3).*P(1,3).*P(2,2).*x0(:,3) - N(:,1).*P(2,2).*P(3,3).*x0(:,1).*pos2D(:,1) + N(:,1).*P(2,3).*P(3,2).*x0(:,1).*pos2D(:,1) + N(:,1).*P(1,2).*P(3,3).*x0(:,1).*pos2D(:,2) - N(:,1).*P(1,3).*P(3,2).*x0(:,1).*pos2D(:,2) - N(:,2).*P(2,2).*P(3,3).*pos2D(:,1).*x0(:,2) + N(:,2).*P(2,3).*P(3,2).*pos2D(:,1).*x0(:,2) + N(:,2).*P(1,2).*P(3,3).*x0(:,2).*pos2D(:,2) - N(:,2).*P(1,3).*P(3,2).*x0(:,2).*pos2D(:,2) - N(:,3).*P(2,2).*P(3,3).*pos2D(:,1).*x0(:,3) + N(:,3).*P(2,3).*P(3,2).*pos2D(:,1).*x0(:,3) + N(:,3).*P(1,2).*P(3,3).*pos2D(:,2).*x0(:,3) - N(:,3).*P(1,3).*P(3,2).*pos2D(:,2).*x0(:,3))./(N(:,1).*P(1,2).*P(2,3) - N(:,1).*P(1,3).*P(2,2) - N(:,2).*P(1,1).*P(2,3) + N(:,2).*P(1,3).*P(2,1) + N(:,3).*P(1,1).*P(2,2) - N(:,3).*P(1,2).*P(2,1) + N(:,1).*P(2,2).*P(3,3).*pos2D(:,1) - N(:,1).*P(2,3).*P(3,2).*pos2D(:,1) - N(:,2).*P(2,1).*P(3,3).*pos2D(:,1) + N(:,2).*P(2,3).*P(3,1).*pos2D(:,1) + N(:,3).*P(2,1).*P(3,2).*pos2D(:,1) - N(:,3).*P(2,2).*P(3,1).*pos2D(:,1) - N(:,1).*P(1,2).*P(3,3).*pos2D(:,2) + N(:,1).*P(1,3).*P(3,2).*pos2D(:,2) + N(:,2).*P(1,1).*P(3,3).*pos2D(:,2) - N(:,2).*P(1,3).*P(3,1).*pos2D(:,2) - N(:,3).*P(1,1).*P(3,2).*pos2D(:,2) + N(:,3).*P(1,2).*P(3,1).*pos2D(:,2));
pos(:,2) = (N(:,1).*P(1,3).*P(2,4) - N(:,1).*P(1,4).*P(2,3) - N(:,3).*P(1,1).*P(2,4) + N(:,3).*P(1,4).*P(2,1) - N(:,1).*P(1,1).*P(2,3).*x0(:,1) + N(:,1).*P(1,3).*P(2,1).*x0(:,1) + N(:,1).*P(2,3).*P(3,4).*pos2D(:,1) - N(:,1).*P(2,4).*P(3,3).*pos2D(:,1) - N(:,3).*P(2,1).*P(3,4).*pos2D(:,1) + N(:,3).*P(2,4).*P(3,1).*pos2D(:,1) - N(:,2).*P(1,1).*P(2,3).*x0(:,2) + N(:,2).*P(1,3).*P(2,1).*x0(:,2) - N(:,1).*P(1,3).*P(3,4).*pos2D(:,2) + N(:,1).*P(1,4).*P(3,3).*pos2D(:,2) + N(:,3).*P(1,1).*P(3,4).*pos2D(:,2) - N(:,3).*P(1,4).*P(3,1).*pos2D(:,2) - N(:,3).*P(1,1).*P(2,3).*x0(:,3) + N(:,3).*P(1,3).*P(2,1).*x0(:,3) - N(:,1).*P(2,1).*P(3,3).*x0(:,1).*pos2D(:,1) + N(:,1).*P(2,3).*P(3,1).*x0(:,1).*pos2D(:,1) + N(:,1).*P(1,1).*P(3,3).*x0(:,1).*pos2D(:,2) - N(:,1).*P(1,3).*P(3,1).*x0(:,1).*pos2D(:,2) - N(:,2).*P(2,1).*P(3,3).*pos2D(:,1).*x0(:,2) + N(:,2).*P(2,3).*P(3,1).*pos2D(:,1).*x0(:,2) + N(:,2).*P(1,1).*P(3,3).*x0(:,2).*pos2D(:,2) - N(:,2).*P(1,3).*P(3,1).*x0(:,2).*pos2D(:,2) - N(:,3).*P(2,1).*P(3,3).*pos2D(:,1).*x0(:,3) + N(:,3).*P(2,3).*P(3,1).*pos2D(:,1).*x0(:,3) + N(:,3).*P(1,1).*P(3,3).*pos2D(:,2).*x0(:,3) - N(:,3).*P(1,3).*P(3,1).*pos2D(:,2).*x0(:,3))./(N(:,1).*P(1,2).*P(2,3) - N(:,1).*P(1,3).*P(2,2) - N(:,2).*P(1,1).*P(2,3) + N(:,2).*P(1,3).*P(2,1) + N(:,3).*P(1,1).*P(2,2) - N(:,3).*P(1,2).*P(2,1) + N(:,1).*P(2,2).*P(3,3).*pos2D(:,1) - N(:,1).*P(2,3).*P(3,2).*pos2D(:,1) - N(:,2).*P(2,1).*P(3,3).*pos2D(:,1) + N(:,2).*P(2,3).*P(3,1).*pos2D(:,1) + N(:,3).*P(2,1).*P(3,2).*pos2D(:,1) - N(:,3).*P(2,2).*P(3,1).*pos2D(:,1) - N(:,1).*P(1,2).*P(3,3).*pos2D(:,2) + N(:,1).*P(1,3).*P(3,2).*pos2D(:,2) + N(:,2).*P(1,1).*P(3,3).*pos2D(:,2) - N(:,2).*P(1,3).*P(3,1).*pos2D(:,2) - N(:,3).*P(1,1).*P(3,2).*pos2D(:,2) + N(:,3).*P(1,2).*P(3,1).*pos2D(:,2));
pos(:,3) = (N(:,3).*x0(:,3) + N(:,1).*(x0(:,1) - pos(:,1)) + N(:,2).*(x0(:,2) - pos(:,2)))./N(:,3);

end

